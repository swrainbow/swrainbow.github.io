---
title: Gimbal lock理解
date: 2023-07-09 17:14:58
tags: [图形学]
categories: [图形学]
cover: https://strainbow.oss-cn-hangzhou.aliyuncs.com/20230713154034.png
---
可以先看B站解析视频[无伤理解欧拉角中的“万向死锁”现象](https://www.bilibili.com/video/BV1Nr4y1j7kn/?spm_id_from=333.999.0.0&vd_source=dc8bc359da1cacb67fa6054d14862294)
# 欧拉角
欧拉角用来在3D世界中表示物体的朝向，从物体的最初始状态（一般会选择和世界坐标系重合作为最初状态）绕着自身坐标系的xyz三个轴进行旋转三个角度，来表示物体的朝向。

有一点需要说明的是，欧拉角描述的绕着坐标轴的旋转，都是绕着物体的本地坐标系的坐标轴进行旋转。可见下面的动图：
![动图](https://pic1.zhimg.com/v2-78d658ec727f3d4501676d03cb912a7c_b.webp)

欧拉角并不是一个静态的数字，它其实是表示从物体的初始状态到目的状态的一个转换过程——进行坐标轴的旋转。

由于使用角度进行表示，那么就会存在一个朝向有无数种角度表示，因此一般欧拉角会限制角度的范围。例如pitch限制在[-90, 90]以内，roll和yaw限制在[-180, 180]范围内。

# 万向锁
## 数学表示
![](https://strainbow.oss-cn-hangzhou.aliyuncs.com/20230709172621.png)
假设我们按照x-y-z的顺序对物体进行旋转，先绕x轴旋转α度，再绕y轴旋转90度，再绕z轴旋转β度，这个时候就会出现万向锁。这个时候最后绕x轴旋转β角度，最终得到的效果和绕z轴旋转是一样的，这样就退化成只有两个轴的旋转有作用，另一个轴的自由度丢失了。可以在Unity或UE4中设置Rotation的值看看，当改变绕z或绕x旋转的角度时，物体是在绕同一个轴进行旋转。这就会导致在逻辑上出现问题，导致出现明明数据上是有绕z轴旋转，可是最终的姿态却没有绕z轴旋转的现象。
按照上面的旋转矩阵公式，得到
![](https://strainbow.oss-cn-hangzhou.aliyuncs.com/20230709172724.png)
可见，最终的结果只与绕y轴和绕x轴旋转有关，因此无论怎么改变α和β的值，最终的旋转矩阵至于两个轴有关系，另一个轴失去了意义。

## 图像
z轴和x轴重合
![](https://strainbow.oss-cn-hangzhou.aliyuncs.com/20230709173306.png)

![](https://strainbow.oss-cn-hangzhou.aliyuncs.com/20230709173400.png)
此时 旋转z轴和x轴的效果是一样的。
物体丢失了一个旋转轴或者说自由度，此时gimbal-lock就发生了

## 思考

网上一些流行的解释都是基于前面的轴旋转可以带动后面的轴。 后面的轴旋转难道就不可以带动前面的轴吗？
确实， 这只是为了相对理解。真实情况下，只要发生了旋转，后面的轴也会带动前面的轴一起旋转。
好了，那么假设还成立吗？？

欧拉角描述的是变换，变换都是独立的， 而连续的旋转的动画只是调整过程是连续的。
这两种描述都是殊途同归的

你输入的：沿x轴转10°，再沿y轴转90°，最后沿x轴转10°
你想象的：沿飞机的x轴转10°，再沿新得到的y轴转90°，最后沿刚刚得到的x轴转10°
你看到的：卧槽，为什么两次沿x轴转动方向不一样，绝逼是x轴没跟着动
实际发生的：沿飞机的x轴转20°，再沿新得到的y轴转90°

**欧拉角描述相对于初始状态的变换，只和最终状态有关，与过程无关。**


